var R=Object.defineProperty,H=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var D=(s,e,t)=>e in s?R(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,h=(s,e)=>{for(var t in e||(e={}))K.call(e,t)&&D(s,t,e[t]);if(N)for(var t of N(e))F.call(e,t)&&D(s,t,e[t]);return s},x=(s,e)=>H(s,J(e));import{I as z,g as E,_ as b}from"./plugin-vue_export-helper.aa4e3a92.js";import{w as O,Z as A,_ as B,$ as w,K as S,y as u,z as _,A as p,H as U,J as C,a0 as f,Q as l,G as y,M as m,N as v,a1 as G,a2 as Y,a3 as j,a4 as M,a5 as P,a6 as T,a7 as Q,U as W,a8 as X,Y as Z}from"./vendor.2c9ff534.js";const q={class:"p-2"},ee={class:"list-disc ml-6"},te={class:"text-sm"},se=l(" ("),ne=l(") "),oe=l(" raw data "),ae=l(" | "),re=l(" timeline "),ie=O({setup(s){const e=A(B(z,{},{deep:!1,shallow:!0,writeDefaults:!1})),t=w(()=>Object.entries(e.value).map(([o,a])=>h({sessionId:o,lastDataTime:new Date(a.lastData)},a)).sort((o,a)=>a.lastData-o.lastData));return(r,o)=>{const a=S("RouterLink");return u(),_("div",q,[p("ul",ee,[(u(!0),_(U,null,C(f(t),c=>(u(),_("li",null,[l(y(c.sessionId)+" ",1),p("span",te,[se,m(f(G),{time:c.lastDataTime},{default:v(({timeAgo:d})=>[l(y(d),1)]),_:2},1032,["time"]),ne]),m(a,{to:{name:"session.view",params:{sessionId:c.sessionId}}},{default:v(()=>[oe]),_:2},1032,["to"]),ae,m(a,{to:{name:"session.timeline",params:{sessionId:c.sessionId}}},{default:v(()=>[re]),_:2},1032,["to"])]))),256))])])}}});function V(s){return Y({spans:L(w(()=>E("spans",f(s))),ce),logs:L(w(()=>E("logs",f(s))),le)})}function L(s,e){const t=j([]);function r(o){if(!(o&&o.key!==s.value))try{const a=o?o.newValue:localStorage.getItem(s.value);if(!a){t.value=[];return}t.value=e(a)}catch(a){console.error("Error parsing localstorage",s.value,a)}}return r(),M(window,"storage",o=>setTimeout(()=>r(o),0)),t}function ce(s){const e=JSON.parse(s),t=[];return e.forEach(({resource:r,instrumentationLibrarySpans:o})=>{o.forEach(({instrumentationLibrary:a,spans:c})=>{c.forEach(d=>{t.push(x(h({},d),{instrumentationLibrary:a,resource:r}))})})}),t}function le(s){const e=JSON.parse(s),t=[];return e.forEach(({resource:r,instrumentationLibraryLogs:o})=>{o.forEach(({instrumentationLibrary:a,logRecords:c})=>{c.forEach(d=>{t.push(x(h({},d),{instrumentationLibrary:a,resource:r}))})})}),t}const de={class:"font-mono"},ue=O({props:{sessionId:null},setup(s){const t=V(P(s,"sessionId"));return(r,o)=>(u(),_("div",null,[p("pre",de,y(f(t).spans),1)]))}});const _e={props:{sessionId:String},mounted(){const s=V(this.sessionId);var e=s.spans.map((n,i)=>({id:n.spanId,className:n.name,content:n.name,start:n.startTimeUnixNano/1e6,end:n.endTimeUnixNano/1e6,title:`${n.name} - ${(n.startTimeUnixNano/1e6).toFixed(1)} - ${(n.endTimeUnixNano/1e6-n.startTimeUnixNano/1e6).toFixed(1)}ms`}));let t=0;e=e.concat(s.logs.map(n=>({id:t++,content:n.attributes.find(i=>i.key==="event.name").value.stringValue,start:n.timeUnixNano/1e6,type:"point"}))),e.sort((n,i)=>n.start-i.start),e.forEach((n,i)=>{n.group=i});function r(){const n=JSON.parse(JSON.stringify(e));return n.sort((i,I)=>(I.end||I.start)-(i.end||i.start)),n[0]}const o=r(),a=o.end||o.start,c=(o.end||o.start)-e[0].start;var d={verticalScroll:!0,start:e[0].start,end:a+c*.1,zoomKey:"shiftKey",groupOrder:function(n,i){return n.id-i.id}},$=new T;e.forEach((n,i)=>{$.add({id:i,content:n.content})});var g=new Q(this.$refs.container);g.setOptions(d),g.setGroups($),g.setItems(new T(e))}},pe=l(" Hold SHIFT to zoom "),me={ref:"container"};function fe(s,e,t,r,o,a){return u(),_(U,null,[pe,p("div",me,null,512)],64)}var he=b(_e,[["render",fe]]);const ve=[{path:"/",name:"session.list",component:ie},{path:"/view/:sessionId",name:"session.view",component:ue,props:!0},{path:"/timeline/:sessionId",name:"session.timeline",component:he,props:!0}];var ge=W({history:X(),routes:ve});const xe={},we={class:"flex flex-col h-screen w-screen overflow-hidden"},Se={class:"h-12 flex-initial flex border-gray-500 border-b"},ye=l(" Sessions List "),$e={class:"flex-1 overflow-auto"};function Ie(s,e){const t=S("router-link"),r=S("router-view");return u(),_("div",we,[p("div",Se,[m(t,{class:"block p-2 bg-transparent hover:bg-gray-100 hover:text-gray-800",to:"/","exact-active-class":"bg-gray-100 text-blue-600 hover:text-blue-600"},{default:v(()=>[ye]),_:1})]),p("div",$e,[m(r)])])}var Ne=b(xe,[["render",Ie]]);const k=Z(Ne);k.use(ge);k.mount("#app");
