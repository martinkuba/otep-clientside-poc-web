var O=Object.defineProperty,U=Object.defineProperties;var k=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var y=(n,e,t)=>e in n?O(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,f=(n,e)=>{for(var t in e||(e={}))R.call(e,t)&&y(n,t,e[t]);if(S)for(var t of S(e))H.call(e,t)&&y(n,t,e[t]);return n},v=(n,e)=>U(n,k(e));import{I as J,g as $,_ as T}from"./plugin-vue_export-helper.97c540ff.js";import{v as D,M as K,N as F,Q as g,U as x,x as d,y as u,z as _,G as E,H as z,V as m,Y as l,A as w,J as p,Z as h,_ as A,$ as B,a0 as C,a1 as G,a2 as Y,a3 as I,a4 as j,a5 as M,a6 as P,K as Q}from"./vendor.37b59686.js";const W={class:"p-2"},X={class:"list-disc ml-6"},Z={class:"text-sm"},q=l(" ("),ee=l(") "),te=l(" raw data "),se=l(" | "),ne=l(" timeline "),oe=D({setup(n){const e=K(F(J,{},{deep:!1,shallow:!0,writeDefaults:!1})),t=g(()=>Object.entries(e.value).map(([a,o])=>f({sessionId:a,lastDataTime:new Date(o.lastData)},o)).sort((a,o)=>o.lastData-a.lastData));return(r,a)=>{const o=x("RouterLink");return d(),u("div",W,[_("ul",X,[(d(!0),u(E,null,z(m(t),i=>(d(),u("li",null,[l(w(i.sessionId)+" ",1),_("span",Z,[q,p(m(A),{time:i.lastDataTime},{default:h(({timeAgo:s})=>[l(w(s),1)]),_:2},1032,["time"]),ee]),p(o,{to:{name:"session.view",params:{sessionId:i.sessionId}}},{default:h(()=>[te]),_:2},1032,["to"]),se,p(o,{to:{name:"session.timeline",params:{sessionId:i.sessionId}}},{default:h(()=>[ne]),_:2},1032,["to"])]))),256))])])}}});function b(n){return B({spans:N(g(()=>$("spans",m(n))),ae),logs:N(g(()=>$("logs",m(n))),re)})}function N(n,e){const t=C([]);function r(a){if(!(a&&a.key!==n.value))try{const o=a?a.newValue:localStorage.getItem(n.value);if(!o){t.value=[];return}t.value=e(o)}catch(o){console.error("Error parsing localstorage",n.value,o)}}return r(),G(window,"storage",a=>setTimeout(()=>r(a),0)),t}function ae(n){const e=JSON.parse(n),t=[];return e.forEach(({resource:r,instrumentationLibrarySpans:a})=>{a.forEach(({instrumentationLibrary:o,spans:i})=>{i.forEach(s=>{t.push(v(f({},s),{instrumentationLibrary:o,resource:r}))})})}),t}function re(n){const e=JSON.parse(n),t=[];return e.forEach(({resource:r,instrumentationLibraryLogs:a})=>{a.forEach(({instrumentationLibrary:o,logRecords:i})=>{i.forEach(s=>{t.push(v(f({},s),{instrumentationLibrary:o,resource:r}))})})}),t}const ie={class:"font-mono"},ce=D({props:{sessionId:null},setup(n){const t=b(Y(n,"sessionId"));return(r,a)=>(d(),u("div",null,[_("pre",ie,w(m(t).spans),1)]))}});const le={props:{sessionId:String},mounted(){const n=b(this.sessionId);var e=n.spans.map((s,c)=>({id:s.spanId,className:s.name,content:s.name,start:s.startTimeUnixNano/1e6,end:s.endTimeUnixNano/1e6,title:`${s.name} - ${(s.startTimeUnixNano/1e6).toFixed(1)} - ${(s.endTimeUnixNano/1e6-s.startTimeUnixNano/1e6).toFixed(1)}ms`}));let t=0;e=e.concat(n.logs.map(s=>({id:t++,content:s.attributes.find(c=>c.key==="event.name").value.stringValue,start:s.timeUnixNano/1e6,type:"point"}))),e.sort((s,c)=>s.start-c.start),e.forEach((s,c)=>{s.group=c});function r(){const s=JSON.parse(JSON.stringify(e));return s.sort((c,V)=>V.end-c.end),s[0]}var a={verticalScroll:!0,start:e[0].start,end:r().end,zoomKey:"shiftKey",groupOrder:function(s,c){return s.id-c.id}},o=new I;e.forEach((s,c)=>{o.add({id:c,content:s.content})});var i=new j(this.$refs.container);i.setOptions(a),i.setGroups(o),i.setItems(new I(e))}},de=l(" Hold SHIFT to zoom "),ue={ref:"container"};function _e(n,e,t,r,a,o){return d(),u(E,null,[de,_("div",ue,null,512)],64)}var pe=T(le,[["render",_e]]);const me=[{path:"/",name:"session.list",component:oe},{path:"/view/:sessionId",name:"session.view",component:ce,props:!0},{path:"/timeline/:sessionId",name:"session.timeline",component:pe,props:!0}];var fe=M({history:P(),routes:me});const he={},ve={class:"flex flex-col h-screen w-screen overflow-hidden"},ge={class:"h-12 flex-initial flex border-gray-500 border-b"},xe=l(" Sessions List "),we={class:"flex-1 overflow-auto"};function Se(n,e){const t=x("router-link"),r=x("router-view");return d(),u("div",ve,[_("div",ge,[p(t,{class:"block p-2 bg-transparent hover:bg-gray-100 hover:text-gray-800",to:"/","exact-active-class":"bg-gray-100 text-blue-600 hover:text-blue-600"},{default:h(()=>[xe]),_:1})]),_("div",we,[p(r)])])}var ye=T(he,[["render",Se]]);const L=Q(ye);L.use(fe);L.mount("#app");
